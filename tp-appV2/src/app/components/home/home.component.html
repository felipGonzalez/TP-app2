<h3 class="row pt-5  "> Datos de reporte para horas extras del personal</h3>

<div class="row">
    <div class="col-md-6 mx-auto">
        <div class="card rounded-0">
            <div class="card-header">
                <h3 class="mb-0">Agregar reporte</h3>
            </div>
            <div class="card-body">
                <form class="from">
                    <div class="form-group">
                        <label for="">Documento</label>
                        <input [(ngModel)]="user.documento" name='documento' type="text" class="form-control round"
                            required>
                    </div>
                    <div class="form-group">
                        <label for="">Nombres</label>
                        <input [(ngModel)]="user.nombres" name='nombres' type="text" class="form-control round"
                            required>
                    </div>
                    <div class="form-group">
                        <label for="">Apellidos</label>
                        <input [(ngModel)]="user.apellidos" name='apellidos' type="text" class="form-control round"
                            required>
                    </div>
                    <div class="row">
                        <div class="col-6">
                            <div class="form-group">
                                <mat-form-field>
                                    <mat-label> Fecha Inicio</mat-label>
                                    <input [(ngModel)]="user.fecha_inicio" name='fecha_inicio'
                                        class="form-control round" required matInput [matDatepicker]="picker1">
                                    <mat-datepicker-toggle matSuffix [for]="picker1"></mat-datepicker-toggle>
                                    <mat-datepicker #picker1></mat-datepicker>
                                </mat-form-field>


                            </div>
                        </div>
                        <div class="col6">
                            <div class="col-6">
                                <div class="form-group">
                                    <mat-form-field>
                                        <mat-label>Fecha Fin</mat-label>
                                        <input [(ngModel)]="user.fecha_fin" name='fecha_fin' class="form-control round"
                                            required matInput [matDatepicker]="picker2">
                                        <mat-datepicker-toggle matSuffix [for]="picker2"></mat-datepicker-toggle>
                                        <mat-datepicker #picker2></mat-datepicker>
                                    </mat-form-field>

                                </div>
                            </div>
                        </div>
                    </div>

                    <p>Hora de inicio de turno</p>
                    <div class="row">

                        <div class="col-6">
                            <mat-form-field>
                                <mat-label>Hora</mat-label>
                                <mat-select (selectionChange)="setHours($event,1)">
                                    <mat-option *ngFor="let item of hours" [value]="item">{{item}}</mat-option>
                                </mat-select>
                            </mat-form-field>

                        </div>
                        <div class="col-6">
                            <mat-form-field>
                                <mat-label>Minuto</mat-label>
                                <mat-select (selectionChange)="setHours($event,2)">
                                    <mat-option *ngFor="let item of min" [value]="item">{{item}}</mat-option>
                                </mat-select>
                            </mat-form-field>
                        </div>
                    </div>
                    <p>Hora fin de turno</p>
                    <div class="row">

                        <div class="col-6">
                            <mat-form-field>
                                <mat-label>Hora</mat-label>
                                <mat-select (selectionChange)="setHours($event,3)">
                                    <mat-option *ngFor="let item of hours" [value]="item">{{item}}</mat-option>
                                </mat-select>
                            </mat-form-field>

                        </div>
                        <div class="col-6">
                            <mat-form-field>
                                <mat-label>Minuto</mat-label>
                                <mat-select (selectionChange)="setHours($event,4)">
                                    <mat-option *ngFor="let item of min" [value]="item">{{item}}</mat-option>
                                </mat-select>
                            </mat-form-field>
                        </div>
                    </div>

                    <div *ngIf="user.horas_extras.length > 0">
                        <h2>
                            Horas extras
                          </h2>
                         

                        <div *ngFor="let hoursEx of user.horas_extras">
                            <hr style="background-color: black;">
                            <div class="row">
                                <div class="col-6"><p>Inicio de hora extra</p></div>
                                <div class="col-6">
                                    <button type="button" class="btn btn-danger float-right" (click)="deleteHoursEx(hoursEx)">Eliminar hora Extra</button>
                                </div>
                            </div>
                            
                            
                    <div class="row">

                        <div class="col-6">
                            <mat-form-field>
                                <mat-label>Hora</mat-label>
                                <mat-select (selectionChange)="setHoursEx(hoursEx,$event,1)">
                                    <mat-option *ngFor="let item of hours" [value]="item">{{item}}</mat-option>
                                </mat-select>
                            </mat-form-field>

                        </div>
                        <div class="col-6">
                            <mat-form-field>
                                <mat-label>Minuto</mat-label>
                                <mat-select (selectionChange)="setHoursEx(hoursEx,$event,2)">
                                    <mat-option *ngFor="let item of min" [value]="item">{{item}}</mat-option>
                                </mat-select>
                            </mat-form-field>
                        </div>
                    </div>
                    
                    <p>Fin de hora extra</p>
                    <div class="row">

                        <div class="col-6">
                            <mat-form-field>
                                <mat-label>Hora</mat-label>
                                <mat-select (selectionChange)="setHoursEx(hoursEx,$event,3)">
                                    <mat-option *ngFor="let item of hours" [value]="item">{{item}}</mat-option>
                                </mat-select>
                            </mat-form-field>

                        </div>
                        <div class="col-6">
                            <mat-form-field>
                                <mat-label>Minuto</mat-label>
                                <mat-select (selectionChange)="setHoursEx(hoursEx,$event,4)">
                                    <mat-option *ngFor="let item of min" [value]="item">{{item}}</mat-option>
                                </mat-select>
                            </mat-form-field>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="">Motivo</label>
                        <input [(ngModel)]="hoursEx.motivo_hora_extra" name='nombres'type="text" class="form-control round" required>
                    </div>
                </div>    
                        
                    </div>
                    <button type="button" class="btn btn-success" (click)="addHoursEx()">Agregar Hora Extra</button>
                </form>
                <button type="button" (click)=saveData() class="btn btn-success btn-lg btn-block mt-5">Guardar</button>
            </div>
        </div>
    </div>

</div>


<h3> <strong>  Tabla de registros </strong></h3>
<table class="table ">
  <thead class="thead-dark">
    <tr>
      <th >Documento</th>
      <th >Nombres</th>
      <th >Apellidos</th>
      <th >Fecha Inicio</th>
      <th>Fecha fin </th>
      <th>Horario inicio de turno</th>
      <th>Horario fin de turno</th>
      <th>Horas Extras</th>
    </tr>
  </thead>
  <tbody>
    <tr *ngFor="let data of listDataAux">
      <td>{{data.documento}}</td>
      <td>{{data.nombres}}</td>
      <td>{{data.apellidos}}</td>
      <td>{{data.fecha_inicio | date :'fullDate'}}</td>
      <td>{{data.fecha_fin | date :'fullDate'}}</td>
      <td>{{gethour(data.horario_inicio_turno)}}</td>
      <td>{{gethour(data.horario_fin_turno)}}</td>
      <td>

        <mat-accordion>
          <mat-expansion-panel>
            <mat-expansion-panel-header>
             
              <mat-panel-title>
                Horas extras
              </mat-panel-title>
            
            </mat-expansion-panel-header>
            <div *ngFor="let i of data.horas_extras" >
              <hr>
              <p>Inicio: {{gethour(i.inicio_hora_extra)}}</p>
              <p>Fin: {{gethour(i.fin_Hora_extra)}}</p>
              <p>Motivo:{{i.motivo_hora_extra}}</p>
            </div>
          </mat-expansion-panel>
        </mat-accordion>
      </td>
    </tr>
 </tbody>
</table>

<hr class="m-5">

